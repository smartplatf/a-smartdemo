/*
*	ImageZoom - Responsive jQuery Image Zoom Pluin
*	by hkeyjun
*   http://codecanyon.net/user/hkeyjun	
*/
(function(a,b){a.ImageZoom=function(d,e){function g(a){var b=parseInt(a);return b=isNaN(b)?0:b}var f=this;f.$el=a(d),f.$el.data("imagezoom",f),f.init=function(b){f.options=a.extend({},a.ImageZoom.defaults,b),f.$viewer=a('<div class="zm-viewer '+f.options.zoomViewerClass+'"></div>').appendTo("body"),f.$handler=a('<div class="zm-handler'+f.options.zoomHandlerClass+'"></div>').appendTo("body"),f.isBigImageReady=-1,f.$largeImg=null,f.isActive=!1,f.$handlerArea=null,f.isWebkit=/chrome/.test(navigator.userAgent.toLowerCase())||/safari/.test(navigator.userAgent.toLowerCase()),f.evt={x:-1,y:-1},f.options.bigImageSrc=""==f.options.bigImageSrc?f.$el.attr("src"):f.options.bigImageSrc,(new Image).src=f.options.bigImageSrc,f.callIndex=a.ImageZoom._calltimes+1,f.animateTimer=null,a.ImageZoom._calltimes+=1,a(document).bind("mousemove.zoompro"+f.callIndex,function(a){f.isActive&&f.moveHandler(a.pageX,a.pageY)}),f.$el.bind("mouseover.zoompro",function(a){f.isActive=!0,f.showViewer(a)})},f.moveHandler=function(a,c){var d=f.$el.offset(),e=f.$el.outerWidth(),h=f.$el.outerHeight();if(a>=d.left&&d.left+e>=a&&c>=d.top&&d.top+h>=c){if(d.left=d.left+g(f.$el.css("borderLeftWidth"))+g(f.$el.css("paddingLeft")),d.top=d.top+g(f.$el.css("borderTopWidth"))+g(f.$el.css("paddingTop")),e=f.$el.width(),h=f.$el.height(),a>=d.left&&d.left+e>=a&&c>=d.top&&d.top+h>=c&&(f.evt={x:a,y:c},"follow"==f.options.type&&f.$viewer.css({top:c-f.$viewer.outerHeight()/2,left:a-f.$viewer.outerWidth()/2}),1==f.isBigImageReady)){var i,j,k=c-d.top,l=a-d.left;if("inner"==f.options.type)i=-f.$largeImg.height()*k/h+k,j=-f.$largeImg.width()*l/e+l;else if("standard"==f.options.type){var m=l-f.$handlerArea.width()/2,n=k-f.$handlerArea.height()/2,o=f.$handlerArea.width(),p=f.$handlerArea.height();0>m?m=0:m>e-o&&(m=e-o),0>n?n=0:n>h-p&&(n=h-p),j=-m/f.scale,i=-n/f.scale,f.isWebkit?(f.$handlerArea.css({opacity:.99}),setTimeout(function(){f.$handlerArea.css({top:n,left:m,opacity:1})},0)):f.$handlerArea.css({top:n,left:m})}else"follow"==f.options.type&&(i=-f.$largeImg.height()/h*k+f.options.zoomSize[1]/2,j=-f.$largeImg.width()/e*l+f.options.zoomSize[0]/2,-i>f.$largeImg.height()-f.options.zoomSize[1]?i=-(f.$largeImg.height()-f.options.zoomSize[1]):i>0&&(i=0),-j>f.$largeImg.width()-f.options.zoomSize[0]?j=-(f.$largeImg.width()-f.options.zoomSize[0]):j>0&&(j=0));f.options.smoothMove?(b.clearTimeout(f.animateTimer),f.smoothMove(j,i)):f.$viewer.find("img").css({top:i,left:j})}}else f.isActive=!1,f.$viewer.hide(),f.$handler.hide(),f.options.onHide(f),b.clearTimeout(f.animateTimer),f.animateTimer=null},f.showViewer=function(b){var c=f.$el.offset().top,d=g(f.$el.css("borderTopWidth")),e=g(f.$el.css("paddingTop")),h=f.$el.offset().left,i=g(f.$el.css("borderLeftWidth")),j=g(f.$el.css("paddingLeft"));c=c+d+e,h=h+i+j;var k=f.$el.width(),l=f.$el.height();if(1>f.isBigImageReady&&a("div",f.$viewer).remove(),"inner"==f.options.type)f.$viewer.css({top:c,left:h,width:k,height:l}).show();else if("standard"==f.options.type){var n,o,m=""==f.options.alignTo?f.$el:a("#"+f.options.alignTo);"left"==f.options.position?(n=m.offset().left-f.options.zoomSize[0]-f.options.offset[0],o=m.offset().top+f.options.offset[1]):"right"==f.options.position&&(n=m.offset().left+m.width()+f.options.offset[0],o=m.offset().top+f.options.offset[1]),f.$viewer.css({top:o,left:n,width:f.options.zoomSize[0],height:f.options.zoomSize[1]}).show(),f.$handlerArea&&(f.scale=k/f.$largeImg.width(),f.$handlerArea.css({width:f.$viewer.width()*f.scale,height:f.$viewer.height()*f.scale}))}else"follow"==f.options.type&&f.$viewer.css({width:f.options.zoomSize[0],height:f.options.zoomSize[1],top:b.pageY-f.options.zoomSize[1]/2,left:b.pageX-f.options.zoomSize[0]/2}).show();f.$handler.css({top:c,left:h,width:k,height:l}).show(),f.options.onShow(f),-1==f.isBigImageReady&&(f.isBigImageReady=0,fastImg(f.options.bigImageSrc,function(){if(a.trim(a(this).attr("src"))==a.trim(f.options.bigImageSrc)){if(f.$viewer.append('<img src="'+f.$el.attr("src")+'" class="zm-fast" style="position:absolute;width:'+this.width+"px;height:"+this.height+'px">'),f.isBigImageReady=1,f.$largeImg=a('<img src="'+f.options.bigImageSrc+'" style="position:absolute;width:'+this.width+"px;height:"+this.height+'px">'),f.$viewer.append(f.$largeImg),"standard"==f.options.type){var c=k/this.width;f.$handlerArea=a('<div class="zm-handlerarea" style="width:'+f.$viewer.width()*c+"px;height:"+f.$viewer.height()*c+'px"></div>').appendTo(f.$handler),f.scale=c}-1==f.evt.x&&-1==f.evt.y?f.moveHandler(b.pageX,b.pageY):f.moveHandler(f.evt.x,f.evt.y),f.options.showDescription&&f.$el.attr("alt")&&""!=a.trim(f.$el.attr("alt"))&&f.$viewer.append('<div class="'+f.options.descriptionClass+'">'+f.$el.attr("alt")+"</div>")}},function(){},function(){}))},f.changeImage=function(a,b){this.$el.attr("src",a),this.isBigImageReady=-1,this.options.bigImageSrc="string"==typeof b?b:a,f.options.preload&&((new Image).src=this.options.bigImageSrc),this.$viewer.hide().empty(),this.$handler.hide().empty(),this.$handlerArea=null},f.changeZoomSize=function(a,b){f.options.zoomSize=[a,b]},f.destroy=function(){a(document).unbind("mousemove.zoompro"+f.callIndex),this.$el.unbind(".zoompro"),this.$viewer.remove(),this.$handler.remove(),this.$el.removeData("imagezoom")},f.smoothMove=function(a,d){var e=10,g=parseInt(f.$largeImg.css("top"));g=isNaN(g)?0:g;var h=parseInt(f.$largeImg.css("left"));if(h=isNaN(h)?0:h,d=parseInt(d),a=parseInt(a),g==d&&h==a)return b.clearTimeout(f.animateTimer),f.animateTimer=null,c;var i=d-g,j=a-h,k=g+i/Math.abs(i)*Math.ceil(Math.abs(i/e)),l=h+j/Math.abs(j)*Math.ceil(Math.abs(j/e));f.$viewer.find("img").css({top:k,left:l}),f.animateTimer=setTimeout(function(){f.smoothMove(a,d)},10)},f.init(e)},a.ImageZoom.defaults={bigImageSrc:"",preload:!0,type:"inner",smoothMove:!0,position:"right",offset:[10,0],alignTo:"",zoomSize:[100,100],descriptionClass:"zm-description",zoomViewerClass:"",zoomHandlerClass:"",showDescription:!0,onShow:function(){},onHide:function(){}},a.ImageZoom._calltimes=0,a.fn.ImageZoom=function(b){return this.each(function(){new a.ImageZoom(this,b)})}})(jQuery,window);var fastImg=function(){var a=[],b=null,c=function(){for(var b=0;a.length>b;b++)a[b].end?a.splice(b--,1):a[b]();!a.length&&d()},d=function(){clearInterval(b),b=null};return function(d,e,f,g){var h,i,j,k,l,m=new Image;return m.src=d,m.complete?(e.call(m),f&&f.call(m),void 0):(i=m.width,j=m.height,m.onerror=function(){g&&g.call(m),h.end=!0,m=m.onload=m.onerror=null},h=function(){k=m.width,l=m.height,(k!==i||l!==j||k*l>1024)&&(e.call(m),h.end=!0)},h(),m.onload=function(){!h.end&&h(),f&&f.call(m),m=m.onload=m.onerror=null},h.end||(a.push(h),null===b&&(b=setInterval(c,40))),void 0)}}();